# Компоненти в Next.JS

Всім привіт, вітаю вас на експрес курсі Next.JS для початківців. Мене звати Віталій Рубан, я працюю в компанії Ітера і сьогодні у нас тема - Компоненти в Next.JS

Я розповім про

- Види компонентів в Next.JS
- Призначення та обмеження серверних компонентів

## Починаємо.

Як ви вже мабуть знаєте, в ReactJS існує два види компонентів - класові та функціональні компоненти, причому функціональні наразі домінують. В свою чергу, Next.JS поділяє всі комопоненти на ще два види - серверні, та універсальні, в залежності від того, де саме рендеряться ваші компоненти. Універсальні компоненти ще називаються клієнтськими, оскільки вони використовують спеціальну директиву `use client` але така назва, як на мене, може збивати з толку, тому що клієнтські компоненти, насправді рендеряться як на клієнті так і на сервері. Власне, тому я й назвав їх - універсальним.

Отже, що таке універсальні компоненти? Універсальні компоненти, це абсолютно звичайні React компоненти які починаються з текстового рядка (директиви) - 'use client' на початку файлу. Окрім директиви, нічим іншим ці компоненти не відрізняються від тих компонентів React до яких ви вже звикли. Вони можуть мати стейт, можуть мати поведінку, використовувати контекст та все інше. При цьому вони також рендеряться на сервері щоб ваш відвідувач побачив контент сторінки якомога швидше, а не чекав поки React йому щось відмалює на клієнті.

Перевагами універсальних компонентів є те, що вони, власне універсальні - можуть мати додану поведінку і все ще рендеряться на сервері. Недоліками є необхдність їх гідрації на клієнті і, відповідно, те що їх залежності додаються в бандл застосунку. Якщо універсальний компонент використовує лодаш, то лодаш буде доданий у бандл, що сповільнює збільшує час який потрібен щоб ваш застосунок став інтерактивним

З серверними компонентами ситуація інша. Ззовні серверні компоненти нічим не відрізняються від звичайних React компонентів. Але в середині відмінність дуже суттєва - **серверні компоненти рендеряться виключно на сервері**. З цього випливають всі інші відмінності.

Оскільки серверні компоненти рендеряться виключно на сервері, то такі компоненти є незмінними і не можуть мати додану поведінку. useState, useEffect, обробники подій - заборонені для використання в серверних компонентах. Окрім цього серверні компоненти не можуть створювати та використовувати звичним нам контекст (але можуть використовувати експерементальний серверний контекст). Що цікаво, нативна поведінка HTML елементів у них повністю зберігається. Так чекбокси будуть чекатися а summary - відкриватися та закриватся. Я покажу це у практичному занятті.

Як бачите обмеження дуже суттєві, а що ж ми отримуємо натомість? Натомість ми отримуємо три переваги. По-перше, оскільки серверні компоненти рендеряться виключно на сервері, ми можемо використовувати асинхронний код прямо в них, без жодних useEffect - це зручно.

По-друге, код, який потрібен для того щоб відмалювати серверний компонент, не потрібно передавати на UI. Відповідно наш бандл стає меншим.

І по-третє, оскільки серверні компоненти не змінні, їх не потрібно гідрувати (тобто перетворювати на інтерактивні) та перерендерювати, що робить ваш застосунок швидшим.

Майте на увазі, що, за замовчуванням, всі компоненти є серверними допоки ви не додали директиву `use client`;

Як бачите - все досить просто. Універсальні компоненти - для компонентів з поведінкою, серверні - для статичних. Щоправда є важливий момент. Директива use-client, автоматично і рекурсивно розповсюджується на всі імпорти. Якщо ви позначите свою сторінку як клієнтську - всі її під компоненти і підкомпоненти її компонент стануть клієнтськими автоматично.

Підведемо підсумки

- В Next.JS є два види компонентів - універсальні та серверні.
- Універсальні компоненти рендеряться і на сервері і на клієнті і можуть мати додану поведінку
- Серверні компоненти рендеряться лише на сервері і є незмінними
- Всі комопоненти за замовчуванням є серверними поки ви не додасте на початок файлу директиву use-client
- Директива `use client` розповсюджуються на всі імпортовані компоненти

Тепер давайте до практики - У нас вже є сторінка зі списком лекцій, тепер давайте додамо можливість поставити лайк статті не читаючи її - прямо зі списку. Серверу у нас ще немає, тому це буде лише заготовка, але, зате, я покажу вам різницю між серверними та клієнтськими компонентами.
